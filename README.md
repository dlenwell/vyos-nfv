# vyos-nfv
Tools to generate a cloud-ready VyOS image
# VyOS NFV tools

## Packer-based QCOW2 image generator

We use a standard Ubuntu LTE (18.04) for this. First some dependencies :

```
wget https://releases.hashicorp.com/packer/1.3.3/packer_1.3.3_linux_amd64.zip # we fetch a recent packer from their website 
unzip packer_1.3.3_linux_amd64.zip && sudo mv packer /usr/local/bin # make the binary available to the system users
adduser $USER kvm # required for packer to use KVM as normal user
```

And then we can generate a new image : 
```
packer build -var-file=vyos-var.json vyos.qcow2.json
```

Adjust variables in vyos-var.json if necessary.

## Vagrant based box

Again, some dependencies. We need to install vagrant and the libvirt provider. Unfortunately on Ubuntu 18.04 the upstream version need some tweaks to get installed at the time of this documentation :

```
wget https://releases.hashicorp.com/vagrant/2.2.3/vagrant_2.2.3_x86_64.deb
dpkg -i vagrant_2.2.3_x86_64.deb
sudo apt-get install libxslt-dev libxml2-dev libvirt-dev zlib1g-dev ruby-dev 
CONFIGURE_ARGS="with-libvirt-include=/usr/include/libvirt with-libvirt-lib=/usr/lib64" vagrant plugin install vagrant-libvirt
```

Then using the box file generated by packer:
```
vagrant box add vyos.box --name vyos
vagrant init vyos # this will generate an editable Vagrantfile
vagrant up --provider=libvirt
```

